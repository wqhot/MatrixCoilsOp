%zhangheng 2013.05 毕业设计matlab%
clear;
 x=[0.01
0.01
0.01
0.01
0.01
0.01
0.01
0.01
0.01
0.02
0.02
0.02
0.02
0.02
0.02
0.02
0.02
0.02
0.03
0.03
0.03
0.03
0.03
0.03
0.03
0.03
0.03
0.04
0.04
0.04
0.04
0.04
0.04
0.04
0.04
0.04
0.05
0.05
0.05
0.05
0.05
0.05
0.05
0.05
0.05
];
 y=[0.01
0.03
0.05
0.01
0.03
0.05
0.01
0.03
0.05
0.01
0.03
0.05
0.01
0.03
0.05
0.01
0.03
0.05
0.01
0.03
0.05
0.01
0.03
0.05
0.01
0.03
0.05
0.01
0.03
0.05
0.01
0.03
0.05
0.01
0.03
0.05
0.01
0.03
0.05
0.01
0.03
0.05
0.01
0.03
0.05
];
 z=[0.01
0.01
0.01
0.03
0.03
0.03
0.05
0.05
0.05
0.01
0.01
0.01
0.03
0.03
0.03
0.05
0.05
0.05
0.01
0.01
0.01
0.03
0.03
0.03
0.05
0.05
0.05
0.01
0.01
0.01
0.03
0.03
0.03
0.05
0.05
0.05
0.01
0.01
0.01
0.03
0.03
0.03
0.05
0.05
0.05
];
bz=[0.000025
0.000025
0.000025
0.000025
0.000025
0.000025
0.000025
0.000025
0.000025
0.00005
0.00005
0.00005
0.00005
0.00005
0.00005
0.00005
0.00005
0.00005
0.000075
0.000075
0.000075
0.000075
0.000075
0.000075
0.000075
0.000075
0.000075
0.0001
0.0001
0.0001
0.0001
0.0001
0.0001
0.0001
0.0001
0.0001
0.000125
0.000125
0.000125
0.000125
0.000125
0.000125
0.000125
0.000125
0.000125
];
a=0.23;r0=0.01;rm=0.42;u0=(1e-7);
c=pi/(rm-r0);

for m=1:45
  for n=1:45
Dq1=@(r,f)u0*r.*((sin(n*c*(r-r0))-n*c*r.*cos(n*c*(r-r0))).*(y(m)-r.*sin(f)).*sin(f).*cos(f)-(sin(n*c*(r-r0)).*sin(f).^2+n*c*r.*cos(n*c*(r-r0)).*cos(f).^2).*(x(m)-r.*cos(f)))./(sqrt((x(m)-r.*cos(f)).^2+(y(m)-r.*sin(f)).^2+(z(m)-a)^2).^3);
Dq2=@(r,f)u0*r.*((sin(n*c*(r-r0))-n*c*r.*cos(n*c*(r-r0))).*(y(m)-r.*sin(f)).*sin(f).*cos(f)-(sin(n*c*(r-r0)).*sin(f).^2+n*c*r.*cos(n*c*(r-r0)).*cos(f).^2).*(x(m)-r.*cos(f)))./(sqrt((x(m)-r.*cos(f)).^2+(y(m)-r.*sin(f)).^2+(z(m)+a)^2).^3);
d(m,n)=(dblquad(Dq1,r0,rm,0,2*pi)+dblquad(Dq2,r0,rm,0,2*pi));
  end
end
dinv=inv(d);
Uq=dinv*bz;
X=linspace(0,rm,100);Y=linspace(-rm,rm,100);
[xx,yy]=meshgrid(X,Y);
s=numel(Uq);Is=0;
for n=1:5
   Is=Is+Uq(n)*sin(n*c*(sqrt(xx.^2+yy.^2)-r0)).*xx./sqrt(xx.^2+yy.^2);
end
Is=-Is;%(这个用离散的xx,yy值查询流函数的最大和最小值)
%jj=@(xx,yy)-(Uq(1)*sin(1*c*(sqrt(xx^2+yy^2)-r0))*xx/sqrt(xx^2+yy^2)+Uq(2)*sin(2*c*(sqrt(xx^2+yy^2)-r0))*xx/sqrt(xx^2+yy^2)+Uq(3)*sin(3*c*(sqrt(xx^2+yy^2)-r0))*xx/sqrt(xx^2+yy^2)+Uq(4)*sin(4*c*(sqrt(xx^2+yy^2)-r0))*xx/sqrt(xx^2+yy^2)+Uq(5)*sin(5*c*(sqrt(xx^2+yy^2)-r0))*xx/sqrt(xx^2+yy^2));%
for t=0:11
jj=@(xx,yy)(-(Uq(1)*sin(1*c*(sqrt(xx^2+yy^2)-r0))*xx/sqrt(xx^2+yy^2)+Uq(2)*sin(2*c*(sqrt(xx^2+yy^2)-r0))*xx/sqrt(xx^2+yy^2)+Uq(3)*sin(3*c*(sqrt(xx^2+yy^2)-r0))*xx/sqrt(xx^2+yy^2)+Uq(4)*sin(4*c*(sqrt(xx^2+yy^2)-r0))*xx/sqrt(xx^2+yy^2)+Uq(5)*sin(5*c*(sqrt(xx^2+yy^2)-r0))*xx/sqrt(xx^2+yy^2))-2.4126e11*(t+0.5));
ezplot(jj,[0,0.4,-0.4,0.4]);
hold on;
end
%ezplot(jj,[0,0.4,-0.4,0.4]);
for t=0:11
   ezplot(jj-2.4126e11*(t+0.5))
    hold on;
end%
